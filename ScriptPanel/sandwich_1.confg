[{"name":"Hello World","group":"Default","script":"alert(\"Hello from injected script !!!\")"},{"name":"Show PBag","group":"SP","script":"(function () { \twindow.spPropertyBag = {}; \twindow.spPropertyBag.init = function () { \t\t\"use strict\"; \t\tvar ctx = new SP.ClientContext.get_current(); \t\tvar web = ctx.get_web(); \t\tvar allProperties = web.get_allProperties(); \t\tctx.load(web); \t\tctx.load(allProperties); \t\tvar reloadRequired = false; \t\tctx.executeQueryAsync(function () { \t\t\tshowPropertiesDialog(allProperties.get_fieldValues()); \t\t}, function (req, err) { \t\t\tSP.UI.Notify.addNotification(\"Failed to get web properties...<br>\" + err.get_message()); \t\t}); \t\twindow.spPropertyBag.executeChanges = function () { \t\t\tctx.get_web().update(); \t\t\tctx.executeQueryAsync(function () { \t\t\t\tconsole.log(\"Web properties successfully modified\"); \t\t\t}, function () { \t\t\t\tconsole.error(\"Failed to set web property!\"); \t\t\t}); \t\t}; \t\twindow.spPropertyBag.setProperty = function (key, inputId) { \t\t\tvar value = document.getElementById(inputId).value; \t\t\tallProperties.set_item(key, value); \t\t\twindow.spPropertyBag.executeChanges(); \t\t}; \t\twindow.spPropertyBag.deleteProperty = function (key, inputId) { \t\t\tif (confirm('Are you sure you want to remove this property?')) { \t\t\t\tvar table = document.getElementById(inputId).parentNode.parentNode; \t\t\t\ttable.parentNode.removeChild(table); \t\t\t\tallProperties.set_item(key); \t\t\t\twindow.spPropertyBag.executeChanges(); \t\t\t\treloadRequired = true; \t\t\t} \t\t}; \t\twindow.spPropertyBag.addProperty = function () { \t\t\tvar key = document.getElementById(\"newKey\").value; \t\t\tvar value = document.getElementById(\"newValue\").value; \t\t\tdocument.getElementById(\"newValue\").value = \"\"; \t\t\tdocument.getElementById(\"newKey\").value = \"\"; \t\t\tallProperties.set_item(key, value); \t\t\twindow.spPropertyBag.executeChanges(); \t\t}; \t\tfunction showPropertiesDialog(props) { \t\t\tvar p, \t\t\ttype; \t\t\tvar items = []; \t\t\tfor (p in props) { \t\t\t\tif (props.hasOwnProperty(p)) { \t\t\t\t\ttype = typeof(props[p]); \t\t\t\t\tif (type === \"string\") { \t\t\t\t\t\titems.push({ \t\t\t\t\t\t\t\"prop\" : p, \t\t\t\t\t\t\t\"value\" : props[p].replace(/\"/g, '&quot;') \t\t\t\t\t\t}); \t\t\t\t\t} \t\t\t\t} \t\t\t} \t\t\titems.sort(function (a, b) { \t\t\t\treturn a.prop.localeCompare(b.prop); \t\t\t}); \t\t\tvar html = document.createElement('div'); \t\t\tvar h = '<hr><table style=\"margin: 1em;\">'; \t\t\tvar i; \t\t\tfor (i = 0; i < items.length; i++) { \t\t\t\th += '<tr>'; \t\t\t\th += '<td style=\"text-align: right; padding-top: 15px;\"><b>' + items[i].prop + '</b></td>'; \t\t\t\th += '<td style=\"padding-top: 15px;\"><input id=\"prop' + i + '\" style=\"width:240px; \" type=\"text\" value=\"' + items[i].value + '\"></inpu></td>'; \t\t\t\th += '<td style=\"padding-top: 15px;\"><button onclick=\"window.spPropertyBag.setProperty('  + items[i].prop + ',' + 'prop' +  i + '); return false;\">Update</button></td>'; \t\t\t\th += '<td style=\"padding-top: 15px;\"><button style=\"color: red; min-width: 1em;\" onclick=\"window.spPropertyBag.deleteProperty('  + items[i].prop +  ',' + 'prop'  + i + '); return false;\">X</button></td>'; \t\t\t\th += '</tr>'; \t\t\t} \t\t\th += '</table>'; \t\t\th += '<hr><h3>Add a new property:</h3>'; \t\t\th += '<div style=\"margin: 1em; padding-bottom: 2em;\">Key: <input id=\"newKey\"></inpu>'; \t\t\th += '&nbsp;&nbsp;&nbsp;Value: <input id=\"newValue\"></inpu>'; \t\t\th += '&nbsp;<button onclick=\"window.spPropertyBag.addProperty(); return false;\">Add</button></div>'; \t\t\th += '<div></div>'; \t\t\thtml.innerHTML = h; \t\t\tOpenPopUpPageWithDialogOptions({ \t\t\t\ttitle : \"Property Bag Editor\", \t\t\t\thtml : html, \t\t\t\tallowMaximized : true, \t\t\t\tshowClose : true, \t\t\t\tautoSize : true, \t\t\t\t/*width: 800,*/ \t\t\t\tdialogReturnValueCallback : function (dialogResult) { \t\t\t\t\tif (reloadRequired) { \t\t\t\t\t\twindow.location.reload(); \t\t\t\t\t} \t\t\t\t} \t\t\t}); \t\t} \t}; \twindow.spPropertyBag.init(); })();"},{"name":"Export WPart","group":"SP","script":"(function () { \twindow.spExportWebPart = {}; \twindow.spExportWebPart.init = function () { \t\tvar webparts = []; \t\tvar getCommonUrlPart = (function () { \t\t\tvar commonUrlPart = undefined; \t\t\tfunction assembleCommonUrlPart() { \t\t\t\treturn [_spPageContextInfo.webAbsoluteUrl, '/_vti_bin/exportwp.aspx?pageurl=', window.location.protocol, '//', window.location.host, _spPageContextInfo.serverRequestPath, '&guidstring='].join(''); \t\t\t} \t\t\treturn function () { \t\t\t\tcommonUrlPart = commonUrlPart || assembleCommonUrlPart(); \t\t\t\treturn commonUrlPart; \t\t\t} \t\t})(); \t\tfunction getAllWebParts(success, error) { \t\t\tvar ctx = SP.ClientContext.get_current(); \t\t\tvar oFile = ctx.get_web().getFileByServerRelativeUrl(_spPageContextInfo.serverRequestPath); \t\t\tvar limitedWebPartManager = oFile.getLimitedWebPartManager(SP.WebParts.PersonalizationScope.shared); \t\t\tvar webPartDefs = limitedWebPartManager.get_webParts(); \t\t\tctx.load(webPartDefs, 'Include(Id, WebPart)'); \t\t\tctx.executeQueryAsync(function () { \t\t\t\tfor (var i = 0; i < webPartDefs.get_count(); i++) { \t\t\t\t\tvar webPartDef = webPartDefs.getItemAtIndex(i); \t\t\t\t\tif (webPartDef.get_id() !== SP.Guid.get_empty().toString()) { \t\t\t\t\t\tvar webPart = webPartDef.get_webPart(); \t\t\t\t\t\twebparts.push({ \t\t\t\t\t\t\tid : webPartDef.get_id(), \t\t\t\t\t\t\ttitle : webPart.get_title() \t\t\t\t\t\t}); \t\t\t\t\t} \t\t\t\t} \t\t\t\tsuccess(); \t\t\t}, function (sender, args) { \t\t\t\terror && error(); \t\t\t}); \t\t} \t\tfunction getWebPartsAsHtml() { \t\t\tvar webpartsAsHtml = webparts.map(function (w) { \t\t\t\t\tvar url = getCommonUrlPart() + w.id; \t\t\t\t\treturn ['<li><a href=\"', url, '\">', w.title, '</a></li>'].join(''); \t\t\t\t}); \t\t\treturn webpartsAsHtml.join(''); \t\t} \t\tfunction getHtml() { \t\t\tvar explanation = ['<div>Please click on the link for you web part to export the webpart</div>', '<div>In future I will try to provide a better interface for selecting your webpart</div>', '<div>The tool is provided as is. Author: Anatoly Mironov @mirontoli, 2015-10-21. See the details on my blog: <a href=\"http://chuvash.eu\">Export Any WebPart using a bookmarklet</a></div>'].join(''); \t\t\treturn [explanation, '<ul>', getWebPartsAsHtml(), '</ul>'].join(''); \t\t} \t\tfunction showDialog() { \t\t\tvar html = document.createElement('div'); \t\t\thtml.innerHTML = getHtml(); \t\t\tOpenPopUpPageWithDialogOptions({ \t\t\t\ttitle : \"Export Web Part\", \t\t\t\thtml : html, \t\t\t\tallowMaximized : true, \t\t\t\tshowClose : true, \t\t\t\tautoSize : true, \t\t\t}); \t\t} \t\tfunction commonError() { \t\t\talert(\"Well, something went wrong\"); \t\t} \t\tfunction renderDialog() { \t\t\tgetAllWebParts(showDialog, commonError); \t\t} \t\trenderDialog(); \t}; \twindow.spExportWebPart.init(); })();"}]