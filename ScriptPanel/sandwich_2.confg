[{"name":"Hello World","group":"Default","script":"alert(\"Hello from injected script !!!\")"},{"name":"PBag-Edit","group":"SP","script":"(function () { \twindow.spPropertyBag = {}; \twindow.spPropertyBag.init = function () { \t\t\"use strict\"; \t\tvar ctx = new SP.ClientContext.get_current(); \t\tvar web = ctx.get_web(); \t\tvar allProperties = web.get_allProperties(); \t\tctx.load(web); \t\tctx.load(allProperties); \t\tvar reloadRequired = false; \t\tctx.executeQueryAsync(function () { \t\t\tshowPropertiesDialog(allProperties.get_fieldValues()); \t\t}, function (req, err) { \t\t\tSP.UI.Notify.addNotification(\"Failed to get web properties...<br>\" + err.get_message()); \t\t}); \t\twindow.spPropertyBag.executeChanges = function () { \t\t\tctx.get_web().update(); \t\t\tctx.executeQueryAsync(function () { \t\t\t\tconsole.log(\"Web properties successfully modified\"); \t\t\t}, function () { \t\t\t\tconsole.error(\"Failed to set web property!\"); \t\t\t}); \t\t}; \t\twindow.spPropertyBag.setProperty = function (key, inputId) { \t\t\tvar value = document.getElementById(inputId).value; \t\t\tallProperties.set_item(key, value); \t\t\twindow.spPropertyBag.executeChanges(); \t\t}; \t\twindow.spPropertyBag.deleteProperty = function (key, inputId) { \t\t\tif (confirm('Are you sure you want to remove this property?')) { \t\t\t\tvar table = document.getElementById(inputId).parentNode.parentNode; \t\t\t\ttable.parentNode.removeChild(table); \t\t\t\tallProperties.set_item(key); \t\t\t\twindow.spPropertyBag.executeChanges(); \t\t\t\treloadRequired = true; \t\t\t} \t\t}; \t\twindow.spPropertyBag.addProperty = function () { \t\t\tvar key = document.getElementById(\"newKey\").value; \t\t\tvar value = document.getElementById(\"newValue\").value; \t\t\tdocument.getElementById(\"newValue\").value = \"\"; \t\t\tdocument.getElementById(\"newKey\").value = \"\"; \t\t\tallProperties.set_item(key, value); \t\t\twindow.spPropertyBag.executeChanges(); \t\t}; \t\tfunction showPropertiesDialog(props) { \t\t\tvar p, \t\t\ttype; \t\t\tvar items = []; \t\t\tfor (p in props) { \t\t\t\tif (props.hasOwnProperty(p)) { \t\t\t\t\ttype = typeof(props[p]); \t\t\t\t\tif (type === \"string\") { \t\t\t\t\t\titems.push({ \t\t\t\t\t\t\t\"prop\" : p, \t\t\t\t\t\t\t\"value\" : props[p].replace(/\"/g, '&quot;') \t\t\t\t\t\t}); \t\t\t\t\t} \t\t\t\t} \t\t\t} \t\t\titems.sort(function (a, b) { \t\t\t\treturn a.prop.localeCompare(b.prop); \t\t\t}); \t\t\tvar html = document.createElement('div'); \t\t\tvar h = '<hr><table style=\"margin: 1em;\">'; \t\t\tvar i; \t\t\tfor (i = 0; i < items.length; i++) { \t\t\t\th += '<tr>'; \t\t\t\th += '<td style=\"text-align: right; padding-top: 15px;\"><b>' + items[i].prop + '</b></td>'; \t\t\t\th += '<td style=\"padding-top: 15px;\"><input id=\"prop' + i + '\" style=\"width:240px; \" type=\"text\" value=\"' + items[i].value + '\"></inpu></td>'; \t\t\t\th += '<td style=\"padding-top: 15px;\"><button onclick=\"window.spPropertyBag.setProperty('  + items[i].prop + ',' + 'prop' +  i + '); return false;\">Update</button></td>'; \t\t\t\th += '<td style=\"padding-top: 15px;\"><button style=\"color: red; min-width: 1em;\" onclick=\"window.spPropertyBag.deleteProperty('  + items[i].prop +  ',' + 'prop'  + i + '); return false;\">X</button></td>'; \t\t\t\th += '</tr>'; \t\t\t} \t\t\th += '</table>'; \t\t\th += '<hr><h3>Add a new property:</h3>'; \t\t\th += '<div style=\"margin: 1em; padding-bottom: 2em;\">Key: <input id=\"newKey\"></inpu>'; \t\t\th += '&nbsp;&nbsp;&nbsp;Value: <input id=\"newValue\"></inpu>'; \t\t\th += '&nbsp;<button onclick=\"window.spPropertyBag.addProperty(); return false;\">Add</button></div>'; \t\t\th += '<div></div>'; \t\t\thtml.innerHTML = h; \t\t\tOpenPopUpPageWithDialogOptions({ \t\t\t\ttitle : \"Property Bag Editor\", \t\t\t\thtml : html, \t\t\t\tallowMaximized : true, \t\t\t\tshowClose : true, \t\t\t\tautoSize : true, \t\t\t\t/*width: 800,*/ \t\t\t\tdialogReturnValueCallback : function (dialogResult) { \t\t\t\t\tif (reloadRequired) { \t\t\t\t\t\twindow.location.reload(); \t\t\t\t\t} \t\t\t\t} \t\t\t}); \t\t} \t}; \twindow.spPropertyBag.init(); })();"},{"name":"Export WPart","group":"SP","script":"(function () { \twindow.spExportWebPart = {}; \twindow.spExportWebPart.init = function () { \t\tvar webparts = []; \t\tvar getCommonUrlPart = (function () { \t\t\tvar commonUrlPart = undefined; \t\t\tfunction assembleCommonUrlPart() { \t\t\t\treturn [_spPageContextInfo.webAbsoluteUrl, '/_vti_bin/exportwp.aspx?pageurl=', window.location.protocol, '//', window.location.host, _spPageContextInfo.serverRequestPath, '&guidstring='].join(''); \t\t\t} \t\t\treturn function () { \t\t\t\tcommonUrlPart = commonUrlPart || assembleCommonUrlPart(); \t\t\t\treturn commonUrlPart; \t\t\t} \t\t})(); \t\tfunction getAllWebParts(success, error) { \t\t\tvar ctx = SP.ClientContext.get_current(); \t\t\tvar oFile = ctx.get_web().getFileByServerRelativeUrl(_spPageContextInfo.serverRequestPath); \t\t\tvar limitedWebPartManager = oFile.getLimitedWebPartManager(SP.WebParts.PersonalizationScope.shared); \t\t\tvar webPartDefs = limitedWebPartManager.get_webParts(); \t\t\tctx.load(webPartDefs, 'Include(Id, WebPart)'); \t\t\tctx.executeQueryAsync(function () { \t\t\t\tfor (var i = 0; i < webPartDefs.get_count(); i++) { \t\t\t\t\tvar webPartDef = webPartDefs.getItemAtIndex(i); \t\t\t\t\tif (webPartDef.get_id() !== SP.Guid.get_empty().toString()) { \t\t\t\t\t\tvar webPart = webPartDef.get_webPart(); \t\t\t\t\t\twebparts.push({ \t\t\t\t\t\t\tid : webPartDef.get_id(), \t\t\t\t\t\t\ttitle : webPart.get_title() \t\t\t\t\t\t}); \t\t\t\t\t} \t\t\t\t} \t\t\t\tsuccess(); \t\t\t}, function (sender, args) { \t\t\t\terror && error(); \t\t\t}); \t\t} \t\tfunction getWebPartsAsHtml() { \t\t\tvar webpartsAsHtml = webparts.map(function (w) { \t\t\t\t\tvar url = getCommonUrlPart() + w.id; \t\t\t\t\treturn ['<li><a href=\"', url, '\">', w.title, '</a></li>'].join(''); \t\t\t\t}); \t\t\treturn webpartsAsHtml.join(''); \t\t} \t\tfunction getHtml() { \t\t\tvar explanation = ['<div>Please click on the link for you web part to export the webpart</div>', '<div>In future I will try to provide a better interface for selecting your webpart</div>', '<div>The tool is provided as is. Author: Anatoly Mironov @mirontoli, 2015-10-21. See the details on my blog: <a href=\"http://chuvash.eu\">Export Any WebPart using a bookmarklet</a></div>'].join(''); \t\t\treturn [explanation, '<ul>', getWebPartsAsHtml(), '</ul>'].join(''); \t\t} \t\tfunction showDialog() { \t\t\tvar html = document.createElement('div'); \t\t\thtml.innerHTML = getHtml(); \t\t\tOpenPopUpPageWithDialogOptions({ \t\t\t\ttitle : \"Export Web Part\", \t\t\t\thtml : html, \t\t\t\tallowMaximized : true, \t\t\t\tshowClose : true, \t\t\t\tautoSize : true, \t\t\t}); \t\t} \t\tfunction commonError() { \t\t\talert(\"Well, something went wrong\"); \t\t} \t\tfunction renderDialog() { \t\t\tgetAllWebParts(showDialog, commonError); \t\t} \t\trenderDialog(); \t}; \twindow.spExportWebPart.init(); })();"},{"name":"REST","group":"SP","script":"(function(){;function e(){i++,l===i&&t()}function t(){window.Hcf=window.Hcf||{},Hcf.RestEndpointsBookmarklet=Hcf.RestEndpointsBookmarklet||{},function(e,t,l){\"use strict\";function i(){e.isModalOpened||\"undefined\"!=typeof SP&&SP.SOD.loadMultiple([\"sp.ui.dialog.js\"],function(){o()})}function o(){var t=l.createElement(\"div\"),i=e.config.endpoints,o='<p>The following endpoints are relative to the current site you are browsing. If you want to launch links relative to your current site collection check the \"Relative to site collection\" box below</p><input type=\"checkbox\" id=\"hcfRestEndpoints_relativeSiteCollection\" value=\"0\" /><label for=\"hcfRestEndpoints_relativeSiteCollection\">&nbsp;Relative to site collection</label><br /><br />';for(var s in i){o+=\"<h3>\"+i[s].title+\"</h3>\";for(var n in i[s].links)o+='<a href=\"'+i[s].links[n].url+'\" onclick=\"Hcf.RestEndpointsBookmarklet.execLink(this);return false;\">'+i[s].links[n].title+\"</a><br />\";o+=\"<br />\"}t.innerHTML=o;var r={title:\"REST API endpoints\",html:t,dialogReturnValueCallback:function(){e.isModalOpened=!1}};SP.UI.ModalDialog.showModalDialog(r),e.isModalOpened=!0}function s(){var e;return e=a?\"/\"===_spPageContextInfo.siteServerRelativeUrl?_spPageContextInfo.siteServerRelativeUrl:_spPageContextInfo.siteServerRelativeUrl+\"/\":\"/\"===_spPageContextInfo.webServerRelativeUrl?_spPageContextInfo.webServerRelativeUrl:_spPageContextInfo.webServerRelativeUrl+\"/\"}function n(){return a?\"site\":\"web\"}var r,a=!1;e.execLink=function(i){var o,c=i.getAttribute(\"href\");return r||(r=l.getElementById(\"hcfRestEndpoints_relativeSiteCollection\")),a=r.checked,o=s()+e.config.apiPrefix+c.replace(\"~scope\",n()),t.open(o,\"_blank\"),!1},e.config={apiPrefix:\"_api/\",endpoints:{lists:{title:\"Lists\",links:{allLists:{url:\"~scope/lists\",title:\"All lists\"},listByTitle:{title:\"List by title\",url:\"~scope/lists/GetByTitle('Documents')\"},listItemsByTitle:{title:\"List items by title\",url:\"~scope/lists/GetByTitle('Documents')/items\"},listItemsByTitleSort:{title:\"List items by title (with sort order)\",url:\"~scope/lists/getByTitle('Documents')/items?$orderby=Title asc\"},listItemsByTitleFilter:{title:\"List items by title (with filter and top 10 results)\",url:\"~scope/lists/getByTitle('Documents')/items?$filter=Title eq 'Test'&$top=10\"},listByGuid:{title:\"List by GUID\",url:\"~scope/lists(guid'b70c7a25-f0e2-494b-83f6-5b13ab840ad2')\"},listItemsByGuid:{title:\"List items by GUID\",url:\"~scope/lists(guid'b70c7a25-f0e2-494b-83f6-5b13ab840ad2')/items\"}}},search:{title:\"Search\",links:{search:{title:\"Search query\",url:\"search/query?queryText='term'\"}}},social:{title:\"Social\",links:{followed:{title:\"Followed\",url:\"social.following/followed\"},usersImFollowing:{title:\"Users I'm following\",url:\"social.following/my/followed(types=1)\"},sitesImFollowing:{title:\"Sites I'm following\",url:\"social.following/my/followed(types=4)\"},myFollowers:{title:\"My followers\",url:\"social.following/my/followers\"}}},files:{title:\"Files / Folders\",links:{folder:{title:\"Folder\",url:\"web/GetFolderByServerRelativeUrl('Documents')\"},files:{title:\"Files\",url:\"web/GetFolderByServerRelativeUrl('Documents')/Files\"},file:{title:\"Specific file\",url:\"web/GetFolderByServerRelativeUrl('Documents')/Files('test.txt')\"}}}}},i()}(window.Hcf.RestEndpointsBookmarklet,window,document)}var l=0,i=0;t();;})()"},{"name":"PBag-View","group":"SP","script":"javascript:(function(){;function e(){o++,n===o&&t()}function t(){window.Hcf=window.Hcf||{},Hcf.PropertyBagBookmarklet=Hcf.PropertyBagBookmarklet||{},function(e,t,n){\"use strict\";function o(){e.isModalOpened||\"undefined\"!=typeof SP&&SP.SOD.loadMultiple([\"sp.ui.dialog.js\"],function(){a(),d()})}function a(){i=new SP.ClientContext.get_current,r=i.get_web()}function d(){c=r.get_allProperties(),i.load(c),i.executeQueryAsync(l,function(e,t){\"undefined\"!=typeof console&&console.log(t.get_message())})}function l(){var t,o=c.get_fieldValues(),a=n.createElement(\"div\"),d=' style=\"padding: 5px;\"',l='<table><thead><tr><th align=\"left\"'+d+'>Key</th><th align=\"left\"'+d+\">Value</th></thead>\",i=[];for(var r in o)o.hasOwnProperty(r)&&i.push(r);i.sort();for(var f=0;f<i.length;f++)t=f%2===0?\"\":' style=\"background: #f0f0f0\"',l+=\"<tr\"+t+\"><td\"+d+\">\"+i[f]+\"</td><td\"+d+\">\"+o[i[f]]+\"</td></tr>\";l+=\"</table>\",a.innerHTML=l;var s={title:\"Property bag (current site)\",html:a,dialogReturnValueCallback:function(){e.isModalOpened=!1}};SP.UI.ModalDialog.showModalDialog(s),e.isModalOpened=!0}var i,r,c;o()}(Hcf.PropertyBagBookmarklet,window,document)}var n=0,o=0;t();;})()"}]